---
title: Integración de Azure Storage
description: Complete este curso para aprender a implementar Azure Table Storage y Azure Blob Storage en una aplicación de HoloLens 2.
author: jessemcculloch
ms.author: jemccull
ms.date: 02/05/2021
ms.topic: article
keywords: mixed reality, unity, tutorial, hololens, hololens 2, azure storage, azure cloud services, Windows 10
ms.localizationpriority: high
ms.openlocfilehash: cebf86901ec7b91888e1e46a13e5dee47f640c6c
ms.sourcegitcommit: 68140e9ce84e69a99c2b3d970c7b8f2927a7fc93
ms.translationtype: HT
ms.contentlocale: es-ES
ms.lasthandoff: 02/05/2021
ms.locfileid: "99590567"
---
# <a name="2-integrating-azure-storage"></a><span data-ttu-id="2140a-104">2. Integración de Azure Storage</span><span class="sxs-lookup"><span data-stu-id="2140a-104">2. Integrating Azure storage</span></span>

<span data-ttu-id="2140a-105">En este tutorial, obtendrá información sobre cómo guardar datos de entidad en Azure Table Storage e imágenes en miniatura en Azure Blob Storage.</span><span class="sxs-lookup"><span data-stu-id="2140a-105">In this tutorial, you will learn how to save entity data to Azure Table storage and thumbnail images to Azure Blob storage.</span></span> <span data-ttu-id="2140a-106">Esta característica nos permitirá almacenar y recuperar *objetos de los que se realiza un seguimiento* con datos como el identificador, el nombre, la imagen en miniatura, etc. entre las sesiones y los dispositivos en la nube.</span><span class="sxs-lookup"><span data-stu-id="2140a-106">This feature will allow us to store and retrieve *Tracked Objects* with data like ID, Name, Thumbnail Image, etc. across sessions and devices to the cloud.</span></span>

## <a name="objectives"></a><span data-ttu-id="2140a-107">Objetivos</span><span class="sxs-lookup"><span data-stu-id="2140a-107">Objectives</span></span>

* <span data-ttu-id="2140a-108">Aprender los aspectos básicos de Azure Storage</span><span class="sxs-lookup"><span data-stu-id="2140a-108">Learn the basics about Azure storage</span></span>
* <span data-ttu-id="2140a-109">Aprenda a almacenar, modificar y recuperar datos de Table Storage</span><span class="sxs-lookup"><span data-stu-id="2140a-109">Learn how to store, modify and retrieve data from Table storage</span></span>
* <span data-ttu-id="2140a-110">Aprender a almacenar y eliminar imágenes de Blob Storage</span><span class="sxs-lookup"><span data-stu-id="2140a-110">Learn how to store and delete images from Blob storage</span></span>

## <a name="understanding-azure-storage"></a><span data-ttu-id="2140a-111">Descripción de Azure Storage</span><span class="sxs-lookup"><span data-stu-id="2140a-111">Understanding Azure storage</span></span>

<span data-ttu-id="2140a-112">**Azure Storage** es una solución de almacenamiento de Microsoft en la nube que puede abarcar muchos escenarios y requisitos.</span><span class="sxs-lookup"><span data-stu-id="2140a-112">**Azure storage** is a Microsoft storage solution on the cloud that can cover many scenarios and requirements.</span></span> <span data-ttu-id="2140a-113">Se puede escalar de forma masiva y los desarrolladores pueden acceder a ella fácilmente.</span><span class="sxs-lookup"><span data-stu-id="2140a-113">It can scale massively and is easily approachable by developers.</span></span> <span data-ttu-id="2140a-114">Todos los servicios se pueden consumir en el paraguas de una **cuenta de Azure Storage**.</span><span class="sxs-lookup"><span data-stu-id="2140a-114">All services can be consumed under the umbrella of an **Azure storage Account**.</span></span> <span data-ttu-id="2140a-115">En nuestro caso de uso, usaremos *Table Storage* y *Blob Storage*.</span><span class="sxs-lookup"><span data-stu-id="2140a-115">For our use case we will use *Table storage* and *Blob storage*.</span></span>

<span data-ttu-id="2140a-116">Obtenga más información sobre los [servicios de Azure Storage](https://docs.microsoft.com/azure/storage/blobs/storage-blobs-overview).</span><span class="sxs-lookup"><span data-stu-id="2140a-116">Learn more about [Azure storage services](https://docs.microsoft.com/azure/storage/blobs/storage-blobs-overview).</span></span>

### <a name="azure-table-storage"></a><span data-ttu-id="2140a-117">Azure Table Storage</span><span class="sxs-lookup"><span data-stu-id="2140a-117">Azure Table storage</span></span>

<span data-ttu-id="2140a-118">Estos servicios nos permiten almacenar los datos mediante un mecanismo NoSQL. En este proyecto, lo usaremos para almacenar información sobre el *objeto del que se realiza un seguimiento*, p. ej., el nombre, la descripción, el identificador del delimitador espacial, etc.</span><span class="sxs-lookup"><span data-stu-id="2140a-118">This services allows us to store data in a NoSQL fashion, in this project we will use it to store information about the *Tracked Object* such as: name, description, spatial anchor id, and more.</span></span>

<span data-ttu-id="2140a-119">En el contexto de la aplicación de demostración, necesita dos tablas, una para almacenar información sobre el proyecto con información sobre el estado de los modelos entrenados (puede obtener más información al respecto en el tutorial [Integración de Azure Custom Vision](mr-learning-azure-03.md)) y una segunda tabla para almacenar información sobre los *objetos de los que se realiza un seguimiento*.</span><span class="sxs-lookup"><span data-stu-id="2140a-119">In context of the demo application, you need two Tables, one to store information about the project with information about the state of trained models more about that in the ([Integrating Azure Custom Vision](mr-learning-azure-03.md)) tutorial and a second table to store information about *Tracked Objects*.</span></span>

<span data-ttu-id="2140a-120">Obtenga más información sobre [Azure Table Storage](https://docs.microsoft.com/azure/storage/tables/table-storage-overview).</span><span class="sxs-lookup"><span data-stu-id="2140a-120">Learn more about [Azure Table storage](https://docs.microsoft.com/azure/storage/tables/table-storage-overview).</span></span>

### <a name="azure-blob-storage"></a><span data-ttu-id="2140a-121">Azure Blob Storage</span><span class="sxs-lookup"><span data-stu-id="2140a-121">Azure Blob storage</span></span>

<span data-ttu-id="2140a-122">Este servicio permite almacenar archivos binarios de gran tamaño. Lo usará para almacenar las fotografías tomadas para los *objetos de los que se realiza un seguimiento* como miniatura.</span><span class="sxs-lookup"><span data-stu-id="2140a-122">This service allows to store large binary files, you will use this to store photos taken for *Tracked Objects* as thumbnail.</span></span>
<span data-ttu-id="2140a-123">En el caso de la aplicación de demostración, necesita un contenedor de blobs para almacenar las imágenes.</span><span class="sxs-lookup"><span data-stu-id="2140a-123">For of the demo application you need one Blob Container to store the images.</span></span>

<span data-ttu-id="2140a-124">Obtenga más información sobre [Azure Blob Storage](https://docs.microsoft.com/azure/storage/blobs/storage-blobs-introduction).</span><span class="sxs-lookup"><span data-stu-id="2140a-124">Learn more about [Azure Blob storage](https://docs.microsoft.com/azure/storage/blobs/storage-blobs-introduction).</span></span>

## <a name="preparing-azure-storage"></a><span data-ttu-id="2140a-125">Preparación de Azure Storage</span><span class="sxs-lookup"><span data-stu-id="2140a-125">Preparing Azure Storage</span></span>

<span data-ttu-id="2140a-126">Para consumir los servicios de Azure Storage, necesitará una cuenta de Azure Storage.</span><span class="sxs-lookup"><span data-stu-id="2140a-126">To consume the Azure storage services you will need an Azure storage account.</span></span> <span data-ttu-id="2140a-127">Para crear una cuenta de almacenamiento, consulte [Creación de una cuenta de almacenamiento](https://docs.microsoft.com/azure/storage/common/storage-account-create?tabs=azure-portal).</span><span class="sxs-lookup"><span data-stu-id="2140a-127">To create a storage account, see [Create a storage account](https://docs.microsoft.com/azure/storage/common/storage-account-create?tabs=azure-portal).</span></span> <span data-ttu-id="2140a-128">Para obtener más información sobre las cuentas de almacenamiento, consulte [Información general de la cuenta de Azure Storage](https://docs.microsoft.com/azure/storage/common/storage-account-overview).</span><span class="sxs-lookup"><span data-stu-id="2140a-128">To learn more about storage accounts, see [Azure storage account overview](https://docs.microsoft.com/azure/storage/common/storage-account-overview).</span></span>

<span data-ttu-id="2140a-129">Una vez que tenga una cuenta de almacenamiento, puede recuperar la cadena de conexión desde **Azure Portal** que se necesitará en la siguiente sección de esta lección.</span><span class="sxs-lookup"><span data-stu-id="2140a-129">Once you have a storage account, you can retrieve the connection string from the **Azure Portal** which will be needed in the next section of this lesson.</span></span>

### <a name="optional-azure-storage-explorer"></a><span data-ttu-id="2140a-130">Explorador de Azure Storage opcional</span><span class="sxs-lookup"><span data-stu-id="2140a-130">Optional Azure Storage Explorer</span></span>

<span data-ttu-id="2140a-131">Aunque puede ver y comprobar todos los cambios de datos de la interfaz de usuario dentro de la aplicación, le recomendamos que instale el [Explorador de Azure Storage](https://azure.microsoft.com/features/storage-explorer/).</span><span class="sxs-lookup"><span data-stu-id="2140a-131">While you can see and verify all data changes from the UI inside the application, we recommend to install [Azure Storage Explorer](https://azure.microsoft.com/features/storage-explorer/).</span></span> <span data-ttu-id="2140a-132">Esta herramienta le permite ver los datos en Azure Storage y resulta muy útil para la depuración y el aprendizaje.</span><span class="sxs-lookup"><span data-stu-id="2140a-132">This tool allows you to visually see the data in the Azure storage and is of great help when debugging and learning.</span></span>

> [!TIP]
> <span data-ttu-id="2140a-133">Para realizar pruebas desde el editor de Unity, puede usar un emulador local:</span><span class="sxs-lookup"><span data-stu-id="2140a-133">For testing from inside the Unity editor you can use a local emulator:</span></span>
>
> * <span data-ttu-id="2140a-134">En Windows 10, puede usar el [emulador de Azure Storage](https://docs.microsoft.com/azure/storage/common/storage-use-emulator).</span><span class="sxs-lookup"><span data-stu-id="2140a-134">on Windows 10 you can use [Azure Storage Emulator](https://docs.microsoft.com/azure/storage/common/storage-use-emulator)</span></span>
> * <span data-ttu-id="2140a-135">En MacOS/Linux, puede usar la [imagen de Docker de Azurite](https://hub.docker.com/_/microsoft-azure-storage-azurite) para Docker.</span><span class="sxs-lookup"><span data-stu-id="2140a-135">on MacOS/Linux you can use [Azurite Docker Image](https://hub.docker.com/_/microsoft-azure-storage-azurite) for Docker</span></span>

## <a name="preparing-the-scene"></a><span data-ttu-id="2140a-136">Preparación de la escena</span><span class="sxs-lookup"><span data-stu-id="2140a-136">Preparing the scene</span></span>

<span data-ttu-id="2140a-137">En la ventana Hierarchy (Jerarquía), busque el objeto **DataManager** y selecciónelo.</span><span class="sxs-lookup"><span data-stu-id="2140a-137">In the Hierarchy window, locate the **DataManager** object and select it.</span></span>

![Unity con los campos de configuración del componente de script DataManager que aparecen en el Inspector](images/mr-learning-azure/tutorial2-section4-step1-1.png)

<span data-ttu-id="2140a-139">En la ventana Inspector verá que el componente **DataManager (script)** es el sitio donde se conservan todos los valores de configuración relacionados con **Azure Storage**.</span><span class="sxs-lookup"><span data-stu-id="2140a-139">From the Inspector window you will see that the **DataManager (script)** component is where all **Azure storage** related settings are kept.</span></span> <span data-ttu-id="2140a-140">Ya se han establecido todos los valores de configuración pertinentes. Ahora, solo tiene que reemplazar el campo *Connection String* (Cadena de conexión) por el que puede recuperar en Azure Portal.</span><span class="sxs-lookup"><span data-stu-id="2140a-140">All relevant settings are already set, you just need to replace the *Connection String* field with the one you can retrieve from the Azure Portal.</span></span> <span data-ttu-id="2140a-141">Si usa una solución de emulador de Azure Storage local, puede mantener la *cadena de conexión* que ya proporcionó.</span><span class="sxs-lookup"><span data-stu-id="2140a-141">If you are using a local Azure storage emulator solution, then you can keep the already provided *Connection String*.</span></span>

<span data-ttu-id="2140a-142">El componente **DataManager (script)** es responsable de comunicarse con **Table Storage** y **Blob Storage**, que consumen otros scripts del controlador en los componentes de la interfaz de usuario.</span><span class="sxs-lookup"><span data-stu-id="2140a-142">The **DataManager (script)** is responsible for talking to the **Table storage** and **Blob storage** which is consumed by other controller scripts on the UI components.</span></span>

## <a name="writing-and-reading-data-from-azure-table-storage"></a><span data-ttu-id="2140a-143">Escritura y lectura de datos de Azure Table Storage</span><span class="sxs-lookup"><span data-stu-id="2140a-143">Writing and reading data from Azure Table storage</span></span>

<span data-ttu-id="2140a-144">Una vez esté todo preparado, es el momento de crear un *objeto del que se realizará un seguimiento*.</span><span class="sxs-lookup"><span data-stu-id="2140a-144">With everything prepared it's time to create a *Tracked Object*.</span></span>

<span data-ttu-id="2140a-145">Abra la aplicación en HoloLens, haga clic en **Set Object** (Establecer objeto) y verá cómo el objeto *EnterObjectName* se activará en la jerarquía.</span><span class="sxs-lookup"><span data-stu-id="2140a-145">Open the application on your HoloLens, click on the **Set Object** and you will see how the *EnterObjectName* object will become active in the hierarchy.</span></span> <span data-ttu-id="2140a-146">En este menú, haga clic en la *barra de búsqueda* y escriba el nombre que quiera asignar al *objeto del que se realizará un seguimiento*.</span><span class="sxs-lookup"><span data-stu-id="2140a-146">In this menu click on the *search bar* and type in the name you want to give the *Tracked Object*.</span></span> <span data-ttu-id="2140a-147">Después de proporcionar un nombre, haga clic en el botón **Set Object** (Establecer objeto).</span><span class="sxs-lookup"><span data-stu-id="2140a-147">After providing a name click on the **Set object** button.</span></span> <span data-ttu-id="2140a-148">Se creará el *objeto del que se realizará un seguimiento* en Azure Table Storage y verá la **tarjeta del objeto**.</span><span class="sxs-lookup"><span data-stu-id="2140a-148">This will create the *Tracked Object* on the Azure Table storage and you will see now the **Object Card**.</span></span>

<span data-ttu-id="2140a-149">La **tarjeta del objeto** es una representación de la interfaz de usuario del *objeto del que se realiza el seguimiento* y tendrá un rol importante varias veces en esta serie de tutoriales.</span><span class="sxs-lookup"><span data-stu-id="2140a-149">This **Object Card** is a UI representation of the *Tracked Object* and will have an important role several times in this tutorial series.</span></span>

<span data-ttu-id="2140a-150">Ahora, haga clic en el *cuadro de texto* de la descripción y escriba "Coche", después de hacer clic en el botón **Save** (Guardar) para guardar los cambios.</span><span class="sxs-lookup"><span data-stu-id="2140a-150">Now click on the description *text box* and type in "Car", after that click on the **Save** button to save the changes.</span></span> <span data-ttu-id="2140a-151">Detenga la aplicación y vuelva a ejecutarla.</span><span class="sxs-lookup"><span data-stu-id="2140a-151">Stop the application and rerun it.</span></span>

<span data-ttu-id="2140a-152">Ahora, haga clic en **Search Object** (Buscar objeto) y escriba en la *barra de búsqueda* el nombre que ha utilizado antes al crear el *objeto del que se realiza un seguimiento*.</span><span class="sxs-lookup"><span data-stu-id="2140a-152">Now this time click on **Search Object** and type in the *search bar* the name you have used before when creating the *Tracked Object*.</span></span> <span data-ttu-id="2140a-153">Verá que se recupera la **tarjeta del objeto** con todos los datos de **Azure Table Storage**.</span><span class="sxs-lookup"><span data-stu-id="2140a-153">You will see that the **Object Card** with all the data is retrieved from the **Azure Table storage**.</span></span>

<span data-ttu-id="2140a-154">No dude en cerrar la **tarjeta del objeto** y crear nuevos *objetos de los que se realice un seguimiento*, así como editar sus datos.</span><span class="sxs-lookup"><span data-stu-id="2140a-154">Feel free to close the **Object Card** and create new *Tracked Objects* and edit their data.</span></span>

> [!TIP]
> <span data-ttu-id="2140a-155">Si instaló el [Explorador de Azure Storage](https://azure.microsoft.com/features/storage-explorer/), a continuación, examine la tabla de *objetos* y verá el *objeto del que se realiza un seguimiento*.</span><span class="sxs-lookup"><span data-stu-id="2140a-155">If you have installed the [Azure Storage Explorer](https://azure.microsoft.com/features/storage-explorer/) then look into the *objects* table and you will see there the created *Tracked Object*.</span></span>

## <a name="uploading-and-download-image-from-azure-blob-storage"></a><span data-ttu-id="2140a-156">Carga y descarga de una imagen desde Azure Blob Storage</span><span class="sxs-lookup"><span data-stu-id="2140a-156">Uploading and Download image from Azure Blob storage</span></span>

<span data-ttu-id="2140a-157">En esta sección, usará Azure Blob Storage para cargar y descargar imágenes que se usarán como miniaturas para los *objetos de los que se realiza un seguimiento*.</span><span class="sxs-lookup"><span data-stu-id="2140a-157">In this section you will use the Azure Blob storage to upload and download images that will be used as thumbnails for *Tracked Objects*.</span></span>

> [!NOTE]
> <span data-ttu-id="2140a-158">En este tutorial, la aplicación tomará fotos para cargar imágenes en Blob Storage.</span><span class="sxs-lookup"><span data-stu-id="2140a-158">In this tutorial the application will take photos to upload images to the Blob storage.</span></span> <span data-ttu-id="2140a-159">Si lo ejecuta de forma local desde el editor de Unity, asegúrese de que tiene una cámara web conectada al equipo.</span><span class="sxs-lookup"><span data-stu-id="2140a-159">If you are running this locally from the Unity editor, then make sure that you have a webcam connected to your computer.</span></span>

<span data-ttu-id="2140a-160">Abra la aplicación en HoloLens, haga clic en **Set Object** (Establecer objeto) y escriba en la *barra de búsqueda* el nombre "Coche".</span><span class="sxs-lookup"><span data-stu-id="2140a-160">Open the application on your HoloLens, click on **Set Object** and type in the *search bar* the name "Car".</span></span> <span data-ttu-id="2140a-161">Ahora debería ver la **tarjeta del objeto**. Haga clic en el botón **Camera** (Cámara) y se le indicará que realice un gesto de pulsación en el aire para tomar una foto.</span><span class="sxs-lookup"><span data-stu-id="2140a-161">Now you should see the **Object Card**, click on the **Camera** button and you will be instructed to do an AirTap to take a photo.</span></span> <span data-ttu-id="2140a-162">Después de tomar una foto, verá un mensaje en el que se le informará sobre la carga activa y, al cabo de un rato, la imagen deberá aparecer en el lugar en el que se encontraba el marcador de posición.</span><span class="sxs-lookup"><span data-stu-id="2140a-162">After taking a photo you will see a message that informs you about the active upload and after a while the image should appear where the placeholder was before.</span></span>

<span data-ttu-id="2140a-163">Ahora vuelva a ejecutar la aplicación, busque el *objeto del que se realiza un seguimiento* y la imagen cargada previamente debería aparecer como miniatura.</span><span class="sxs-lookup"><span data-stu-id="2140a-163">Now rerun the application and search for the *Tracked Object* and the previously uploaded image should appear as thumbnail.</span></span>

## <a name="deleting-image-from-azure-blob-storage"></a><span data-ttu-id="2140a-164">Eliminación de una imagen de Azure Blob Storage.</span><span class="sxs-lookup"><span data-stu-id="2140a-164">Deleting image from Azure Blob storage</span></span>

<span data-ttu-id="2140a-165">En la sección anterior, cargó imágenes nuevas en Azure Blob Storage y, en esta, eliminará una miniatura de imagen de los *objetos de los que realiza un seguimiento*.</span><span class="sxs-lookup"><span data-stu-id="2140a-165">In the previous section you uploaded new images to Azure Blob storage, in this section you will delete an image thumbnail for *Tracked Objects*.</span></span>

<span data-ttu-id="2140a-166">Abra la aplicación en HoloLens, haga clic en **Set Object** (Establecer objeto) y escriba en la *barra de búsqueda* el nombre "Coche".</span><span class="sxs-lookup"><span data-stu-id="2140a-166">Open the application on your HoloLens, click on **Set Object** and type in the *search bar* the name "Car".</span></span> <span data-ttu-id="2140a-167">Ahora debería ver la **tarjeta del objeto** con la imagen en miniatura. Si es así, haga clic en el botón **Delete** (Eliminar).</span><span class="sxs-lookup"><span data-stu-id="2140a-167">Now you should see the **Object Card** with the thumbnail image, click on the **Delete** button.</span></span> <span data-ttu-id="2140a-168">Observará que la imagen en miniatura se ha reemplazado por la imagen del marcador de posición.</span><span class="sxs-lookup"><span data-stu-id="2140a-168">You will notice that the thumbnail image is replaced by the placeholder image.</span></span>

<span data-ttu-id="2140a-169">Ahora vuelva a ejecutar la aplicación y busque el *objeto del que se realiza un seguimiento* de la miniatura previamente eliminada. Solo debería ver la imagen del marcador de posición.</span><span class="sxs-lookup"><span data-stu-id="2140a-169">Now rerun the application and search for the *Tracked Object* of the previously deleted thumbnail, you should only see the placeholder image.</span></span>

## <a name="congratulations"></a><span data-ttu-id="2140a-170">Enhorabuena</span><span class="sxs-lookup"><span data-stu-id="2140a-170">Congratulations</span></span>

<span data-ttu-id="2140a-171">En este tutorial ha aprendido a usar los servicios de Azure Storage para conservar datos no estructurados, como los **objetos de los que realiza un seguimiento** y los archivos binarios en formato de imágenes en miniatura para la aplicación de demostración de **HoloLens 2** en la nube.</span><span class="sxs-lookup"><span data-stu-id="2140a-171">In this tutorial you learned how Azure storage services can be used to persist unstructured data, like in our case **Tracked Objects** and binaries in form of thumbnail images for the **HoloLens 2** demo application on the cloud.</span></span>

<span data-ttu-id="2140a-172">En el siguiente tutorial, aprenderá a usar Azure Custom Vision para detectar imágenes asociadas a un *objeto del que se realiza un seguimiento*.</span><span class="sxs-lookup"><span data-stu-id="2140a-172">In the next tutorial you will learn how to use Azure Custom Vision to detect images associated with a *Tracked Object*.</span></span>

> [!div class="nextstepaction"]
> [<span data-ttu-id="2140a-173">Tutorial siguiente: 3. Integración de Azure Custom Vision</span><span class="sxs-lookup"><span data-stu-id="2140a-173">Next tutorial: 3. Integrating Azure Custom Vision</span></span>](mr-learning-azure-03.md)
